<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="tarmii.theme"
      lang="en">

<body>
    <metal:main fill-slot="content-title">
        <h1 class="documentFirstHeading" i18n:translate="heading_classperformance_for_activity">Class Performance For Activity</h1>
    </metal:main>

    <metal:main fill-slot="content-core">

    <!-- check: dont allow anonymous role access to this template -->
    <div tal:condition="view/user_anonymous">
    </div>

        <form name="assessment-form" tal:attributes="action string:${view/__name__}" method="post">
                
            <div tal:condition="view/assessments">
                 <table>
                     <tbody>
                        <tr>
                            <th i18n:translate="label_assessment">Assessment</th>
                            <tal:activities tal:condition="view/activities">
                                <th i18n:translate="label_activity">Activity</th>
                            </tal:activities>
                        </tr>
                        <tr>
                            <td class="select-assessment">
                                <select name="assessment_uid_selected" onchange="this.form.submit()">
                                    <option tal:repeat="assessment view/assessments"
                                            tal:attributes="value assessment/UID;
                                                            selected python:assessment.UID == request.get('assessment_uid_selected', '')"
                                            tal:content="assessment/Title">
                                    </option>
                                </select>
                            </td>
                            <tal:activities tal:condition="view/activities">
                                <td class="select-activity">
                                    <select name="activity_uid_selected" onchange="this.form.submit()">
                                        <option tal:repeat="activity view/activities"
                                                tal:attributes="value python:view.getUID(activity.to_object);
                                                                selected python:view.getUID(activity.to_object) ==
                                                                         request.get('activity_uid_selected', '')"
                                                tal:content="python:activity.to_object.id">
                                        </option>
                                    </select>
                                </td>
                            </tal:activities>
                        </tr>
                     </tbody>
                 </table>
            </div>

            <tal:noassessments tal:condition="not:view/activities">
                <tal:evaluations tal:condition="not:view/evaluations">
                    <div i18n:translate="message_no_assesments_or_activities_exist">No assessments have been created yet,
                                                                                or existing assessments contain no activities.</div>
                </tal:evaluations>
            </tal:noassessments>

            <tal:noassessments tal:condition="view/activities">
                <tal:evaluations tal:condition="not:view/evaluations">
                    <div i18n:translate="message_evaluationsheet_incorrect">No evaluationsheets have been created for this assessment.  
                                                                            Alternatively, assessments have been created with an empty 
                                                                            classlist. If this is the case, please add some learners to your 
                                                                            classlist that you are using with this assessment and 
                                                                            recreate the evaluationsheet again.</div>
                </tal:evaluations>            
            </tal:noassessments>

            <tal:noactivities tal:condition="not:view/activities">
                <tal:evaluations tal:condition="view/evaluations">
                    <div i18n:translate="message_no_activities_in_assessment">No activities associated with selected assessment. 
                                                                              Please update the assessment.</div>
                </tal:evaluations>
            </tal:noactivities>
            
        </form>
    
        <tal:activities tal:condition="view/activities">
            <tal:evaluations tal:condition="view/evaluations">
                <img tal:attributes="src string:@@classperformance-for-activity-chart?assessment=${view/selected_assessment}&activity=${view/selected_activity}"/>
            </tal:evaluations>
        </tal:activities>

    </metal:main>
</body>
</html>
