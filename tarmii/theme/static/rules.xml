<?xml version="1.0" encoding="UTF-8"?>
<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <!-- Rules applying to a standard Plone web page -->
    <rules css:if-content="#visual-portal-wrapper">

        <!-- Add meta tags -->
        <drop theme="/html/head/meta" />
        <after content="/html/head/meta" theme-children="/html/head" />
        <append theme="/html/head" content="/html/head/base"/>

        <!-- Copy style, script and link tags in the order they appear in the content -->
        <after
            content="/html/head/style | /html/head/script | /html/head/link"
            theme-children="/html/head"
            />

        <drop theme="/html/head/style" />
        <drop theme="/html/head/script" />

        <!-- Copy over the id/class attributes on the body tag.
             This is important for per-section styling -->
        <merge attributes="class" css:content="body" css:theme="body" />
        <copy attributes="id dir" css:content="body" css:theme="body" />


        <!-- if logged in drop login form -->
        <drop css:theme="#login_form" css:if-content="#user-name" />
        <!-- if logged out drop logged in info strip -->
        <drop css:theme="#personal_pane_logged_in" css:if-not-content="#user-name" />

        <!-- copy hrefs of logged in links from plone to theme -->
        <copy attributes="href" css:content="#personaltools-logout a" css:theme="#log_out" />
        <copy attributes="href" css:content="#personaltools-preferences a" css:theme="#change_prefs" />

        <!-- copy href of logo from plone to theme -->
        <copy attributes="href" css:content="#portal-logo" css:theme="#portal-logo" />

        <!-- info and error messages -->
        <replace css:content=".portalMessage" css:theme=".portalMessage" />

        <!-- main menu navigation -->
        <replace css:content-children="#portal-globalnav" css:theme-children="#menu-globalnav" /> 

        <!-- footer links -->
            <!-- home -->
            <copy attributes="href" css:content="#portal-logo" css:theme="#footer_home_link" />

            <!-- contact -->
            <copy attributes="href" css:content="#siteaction-contact a" css:theme="#footer_contact_link" />


        <!-- THEME -->
        <rules css:if-content=".breadcrumbSeparator">
            <theme href="theme.html" />

            <!-- content -->
            <replace
                css:content-children="#content"
                css:theme-children="#content_pane" />

        </rules>

        <!-- HOME -->
        <rules css:if-not-content=".breadcrumbSeparator">
            <theme href="home.html" />
 
            <drop css:theme="#signup" css:if-content="#user-name" />

        </rules>
    </rules>

</rules>
